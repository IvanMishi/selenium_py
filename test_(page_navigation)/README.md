# Работа с вкладками и окнами

## Инженер по тестированию переходит в директорию, предназначенную для хранения файлов с тестами
```
cd selenium_tests
```
## Из директории selenium_tests активирует виртуальное окружение
```sh
source selenium_env/bin/activate
```
## В активированном окружении запускает тест 
```sh
python3  test_(page_navigation)/test_A.py
```
## Для вывода результата в отдельный файл зпускает командой 
```sh
python3 test_(page_navigation)/test_A.py >> test_A2/output.txt
```
Где test_A.py -  скрипт с тестом, а output.txt - файл, в который будет записан вывод теста.

# Работа с вкладками
 — это отдельное окно внутри одного окна браузера. 
Можно открывать сколько угодно вкладок, но работать можно только с активной.
Особенность работы в нескольких вкладках одновременно, заключается в том, что для взаимодействия с элементами новой вкладки, нам необходимо на нее переключиться.
```driver.switch_to.window(driver.window_handles[1])``` Переключается на новую открытую вкладку браузера
```switch_to.window()``` метод для переключения на новую вкладку.
```window_handles[0]``` указатель на текущую вкладку.
```window_handles[1]``` указатель на новую вкладку.

# Работа с окнами
Работа с несколькими окнами идентична работе с несколькими вкладками.
Для переключения на новое окно нам потребуется следующий  код:

```driver.switch_to.window(driver.window_handles[1])``` Переключается на новое открытое окно браузера
```switch_to.window()``` метод для переключения на новое окно.
```window_handles[0]``` указатель на текущее окно.
```window_handles[1]``` указатель на новое окно.





## Тестовые данные test_A
```data:``` – стартовая вкладка, открываемая Selenium, имеет URL вида data:, или data:text/html. \
 Это  пустая страница, но она создаётся динамически. \
 Из-за отсутствия полноценного HTML-контента, такой документ может не иметь тега <title>, поэтому browser.title возвращает пустую строку.\
```about:blank``` – специальный URL, который загружает пустую страницу. \
Если вызвать driver.get("about:blank"), вы получите чистую страницу, с которой можно начать работу. \


## Тестовые данные test_B
При работе с веб-приложениями часто требуется переходить по ссылкам, открывающимся в новой вкладке браузера. 
WebDriver может взаимодействовать только с одной вкладкой, и при открытии новой он продолжает работать со старой. 
Чтобы переключиться на новую вкладку, необходимо явно указать, на какую вкладку перейти, с помощью команды 
```driver.switch_to.window(window_name)```
```driver.get("Укажите любой URL")```


## Тестовые данные test_C
Метод ```driver.execute_script('window.open("Укажите любой URL", "_blank");')``` 
открывает новую вкладку, но фокус остается на текущей, и для работы с новой вкладкой необходимо явно переключиться. 
Даже после запуска кода фокус визуально будет на вкладке icloud.com, однако фактически она не активна. 
При использовании команды browser.get("https://google.com" новая страница откроется в первой вкладке, несмотря на видимый фокус на icloud.com. 
Такое поведение характерно для методов JavaScript, таких как browser.execute_script, которые не требуют переключения на новую вкладку.


## Тестовые данные test_D
- [x] Незарегестированный пользователь запускает  браузер с пустой вкладкой about:blank
- [x] Использует метод .new_window("tab"), открывает сайт 1 в новой вкладке и получает из title числовое значение, затем удаляет из него все числа 4, 3, 9,  сохраняет обработанное число в num1.
- [x] Открывает сайт 2 тем же методом в новой вкладке и получает из title числовое значение, затем удаляет из него все числа 7, 8, 0,  сохраняет обработанное число в num2.
- [x] Выводит сумму чимсел в качестве ответа в консоль.
#### В программе использует:
```driver.get("about:blank")```Метод используется для открытия пустой страницы в браузере. Эта страница не содержит ни одного элемента и служит "чистой" средой, с которой можно работать.
```driver.switch_to.new_window('tab')``` Метод открывает новую вкладку в текущем окне браузера, что позволяет одновременно работать с несколькими страницами в одном сеансе. Это удобно для многозадачных операций и сбора данных из разных источников.
```num_1 = ''.join(i for i in webdriver.title if i not in ['4', '3', '9'])``` Код извлекает из заголовка текущей страницы (получаемого через webdriver.title) все символы, кроме '4', '3' и '9', создавая таким образом "чистый" заголовок. Это может быть полезно для фильтрации данных.


## Тестовые данные test_E
Код открывает первую вкладку с помощью метода ```.get("URL")```, 
затем добавляет еще три вкладки с помощью ```.execute_script()``` и выводит дескрипторы всех открытых вкладок.

Дескрипторы представляют собой сущности, позволяющие управлять вкладками.
Каждая вкладка имеет свой уникальный идентификатор (дескриптор)
```webdriver.current_window_handle``` — возвращает дескриптор текущей вкладки;
```webdriver.window_handles``` — возвращает список всех дескрипторов открытых вкладок; 
```webdriver.switch_to.window(window_handles[0])``` — переключает фокус между вкладками.
```webdriver.switch_to.window(descriptor)``` — либо передать сам дескриптор на прямую
```webdriver.new_window("window")``` — открыть новое отдельное окно браузера(!не вкладку).

## Тестовые данные test_F
Код открывает первую вкладку с помощью метода browser.get("URL"), 
затем добавляет три новых вкладки через ```webdriver.new_window("tab")```, 
после чего печатает дескрипторы всех открытых вкладок.


## Тестовые данные test_G
Можно работать со всеми вкладками, но только по очереди и исключительно с активной.
Код не вызывает ошибок, так как при отсутствии элементов метод find_elements возвращает пустой список.


## Тестовые данные test_H
Код, использующий Selenium для открытия нескольких вкладок в Chrome через execute_script('window.open(...)'), имеет свои нюансы. 
Открытие всех вкладок одновременно не гарантирует сохранения их порядка в browser.window_handles. 
Chrome добавляет вкладки в этот список в произвольном порядке, исходя из скорости загрузки страниц. 
В результате, после выполнения всех команд execute_script(...), они могут располагаться не в том порядке, в котором были открыты. 
Это создает неопределенность при доступе к конкретным вкладкам, особенно если одна вкладка загружается медленнее другой.
Такое асинхронное поведение следует учитывать при написании кода, поскольку ссылки на вкладки по индексу могут привести к недоразумениям. 
Рекомендуется использовать более гибкие методы доступа к вкладкам, такие как уникальные идентификаторы или временные задержки, чтобы управлять процессом более точно.
В общем, данная реализация требует внимательного анализа для избежания проблем с порядком и доступом к открытым вкладкам.

Для демонстрации процесса итерации по вкладкам был создан следующий пример.
Вкладка с именем "data" не возвращает свое название, так как не содержит тега <title>.

